Wed, Aug 13, 2025  2:33:16 PM: Checking prerequisites
Wed, Aug 13, 2025  2:33:16 PM: SUCCESS - Node.js is available: v20.14.0
Wed, Aug 13, 2025  2:33:17 PM: SUCCESS - npm is available: 10.9.2
Wed, Aug 13, 2025  2:33:17 PM: SUCCESS - package.json found
Wed, Aug 13, 2025  2:33:17 PM: Installing dependencies
Wed, Aug 13, 2025  2:33:52 PM: SUCCESS - Dependencies installed
Wed, Aug 13, 2025  2:33:52 PM: Setting up environment
Wed, Aug 13, 2025  2:33:52 PM: SUCCESS - .env file found
Wed, Aug 13, 2025  2:33:52 PM: Building the application

> ankkor@0.1.0 build
> next build

  ▲ Next.js 14.2.24
  - Environments: .env.local, .env
  - Experiments (use with caution):
    · optimizeCss
    · instrumentationHook

   Creating an optimized production build ...
<w> [webpack.cache.PackFileCacheStrategy] Serializing big strings (126kiB) impacts deserialization performance (consider using Buffer instead and decode when needed)
Browserslist: browsers data (caniuse-lite) is 6 months old. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme
 ✓ Compiled successfully
   Skipping validation of types
   Skipping linting
   Collecting page data ...
Error: @prisma/client did not initialize yet. Please run "prisma generate" and try to import it again.
    at new PrismaClient (E:\ankkorwoo\ankkor\node_modules\.prisma\client\default.js:43:11)
    at 71562 (E:\ankkorwoo\ankkor\.next\server\app\api\cart\route.js:1:646)
    at t (E:\ankkorwoo\ankkor\.next\server\webpack-runtime.js:1:128)
    at a (E:\ankkorwoo\ankkor\.next\server\app\api\cart\route.js:1:80100)
    at E:\ankkorwoo\ankkor\.next\server\app\api\cart\route.js:1:80143
    at t.X (E:\ankkorwoo\ankkor\.next\server\webpack-runtime.js:1:2135)
    at E:\ankkorwoo\ankkor\.next\server\app\api\cart\route.js:1:80113
    at Object.<anonymous> (E:\ankkorwoo\ankkor\.next\server\app\api\cart\route.js:1:80171)
    at Module._compile (node:internal/modules/cjs/loader:1358:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1416:10)

> Build error occurred
Error: Failed to collect page data for /api/cart
    at E:\ankkorwoo\ankkor\node_modules\next\dist\build\utils.js:1269:15
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
  type: 'Error'
}
Wed, Aug 13, 2025  2:34:17 PM: WARNING - Build failed, continuing with development mode
Wed, Aug 13, 2025  2:34:17 PM: Starting the application
Started application with PID: 1335

> ankkor@0.1.0 dev
> next dev

  ▲ Next.js 14.2.24
  - Local:        http://localhost:3000
  - Environments: .env.local, .env
  - Experiments (use with caution):
    · optimizeCss
    · instrumentationHook

 ✓ Starting...
 ✓ Ready in 4.1s
 ○ Compiling /_not-found ...
Browserslist: browsers data (caniuse-lite) is 6 months old. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme
 ✓ Compiled /_not-found in 6.9s (1601 modules)
 GET /api/health 404 in 7252ms
 ✓ Compiled in 650ms (862 modules)
 ○ Compiling /api/cart ...
 ✓ Compiled /api/cart in 572ms (68 modules)
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 2475ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 2, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 2, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:01.825Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 24ms
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) ORDER BY "public"."cart_items"."createdAt" ASC OFFSET $2
 GET /api/cart?cartId=cme9r1zte0000uv7onkogh94g 200 in 881ms
 GET /api/cart?cartId=cme9r1zte0000uv7onkogh94g 200 in 134ms
 ✓ Compiled /api/webhooks/inventory in 86ms (72 modules)
=== WooCommerce Inventory Webhook Received ===
Headers: {
  accept: '*/*',
  'accept-encoding': 'gzip, deflate',
  'accept-language': '*',
  connection: 'keep-alive',
  'content-length': '76',
  'content-type': 'application/json',
  host: 'localhost:3000',
  'sec-fetch-mode': 'cors',
  'user-agent': 'node',
  'x-forwarded-for': '::1',
  'x-forwarded-host': 'localhost:3000',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'http'
}
Body received, length: 76
Body preview: {"id":1,"name":"Test Product","stock_status":"instock","stock_quantity":100}
Skipping signature verification in development mode
Content-Type: application/json
JSON parsed successfully
Webhook data received: {
  id: 1,
  name: 'Test Product',
  slug: undefined,
  stock_status: 'instock',
  stock_quantity: 100
}
Skipping signature verification for debugging
Webhook topic: product.updated
=== handleProductUpdate called ===
Processing product: product-1 (ID: 1)
Added WooCommerce mapping to Redis: 1 -> product-1
Inventory mapping updated successfully
Cache updated: product-1 -> instock (100)
Broadcasting stock update: {
  productId: '1',
  stockData: {
    stockStatus: 'instock',
    stockQuantity: 100,
    availableForSale: true
  }
}
Stock update broadcast completed
=== handleProductUpdate completed ===
Webhook handled successfully
=== Webhook Processing Complete ===
 POST /api/webhooks/inventory 200 in 310ms
=== WooCommerce Inventory Webhook Received ===
Headers: {
  accept: '*/*',
  'accept-encoding': 'gzip, deflate',
  'accept-language': '*',
  connection: 'keep-alive',
  'content-length': '57',
  'content-type': 'application/json',
  host: 'localhost:3000',
  'sec-fetch-mode': 'cors',
  'user-agent': 'node',
  'x-forwarded-for': '127.0.0.1',
  'x-forwarded-host': 'localhost:3000',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'http'
}
=== WooCommerce Inventory Webhook Received ===
Headers: {
  accept: '*/*',
  'accept-encoding': 'gzip, deflate',
  'accept-language': '*',
  connection: 'keep-alive',
  'content-length': '57',
  'content-type': 'application/json',
  host: 'localhost:3000',
  'sec-fetch-mode': 'cors',
  'user-agent': 'node',
  'x-forwarded-for': '127.0.0.1',
  'x-forwarded-host': 'localhost:3000',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'http'
}
Body received, length: 57
Body preview: {"id":0,"name":"Test Product 0","stock_status":"instock"}
Skipping signature verification in development mode
Content-Type: application/json
JSON parsed successfully
Webhook data received: {
  id: 0,
  name: 'Test Product 0',
  slug: undefined,
  stock_status: 'instock',
  stock_quantity: undefined
}
Skipping signature verification for debugging
Webhook topic: product.updated
=== handleProductUpdate called ===
Product missing ID field
Body received, length: 57
Body preview: {"id":1,"name":"Test Product 1","stock_status":"instock"}
Skipping signature verification in development mode
Content-Type: application/json
JSON parsed successfully
Webhook data received: {
  id: 1,
  name: 'Test Product 1',
  slug: undefined,
  stock_status: 'instock',
  stock_quantity: undefined
}
Skipping signature verification for debugging
Webhook topic: product.updated
=== handleProductUpdate called ===
Processing product: product-1 (ID: 1)
Webhook handled successfully
=== Webhook Processing Complete ===
 POST /api/webhooks/inventory 200 in 28ms
=== WooCommerce Inventory Webhook Received ===
Headers: {
  accept: '*/*',
  'accept-encoding': 'gzip, deflate',
  'accept-language': '*',
  connection: 'keep-alive',
  'content-length': '57',
  'content-type': 'application/json',
  host: 'localhost:3000',
  'sec-fetch-mode': 'cors',
  'user-agent': 'node',
  'x-forwarded-for': '127.0.0.1',
  'x-forwarded-host': 'localhost:3000',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'http'
}
=== WooCommerce Inventory Webhook Received ===
Headers: {
  accept: '*/*',
  'accept-encoding': 'gzip, deflate',
  'accept-language': '*',
  connection: 'keep-alive',
  'content-length': '57',
  'content-type': 'application/json',
  host: 'localhost:3000',
  'sec-fetch-mode': 'cors',
  'user-agent': 'node',
  'x-forwarded-for': '127.0.0.1',
  'x-forwarded-host': 'localhost:3000',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'http'
}
=== WooCommerce Inventory Webhook Received ===
Headers: {
  accept: '*/*',
  'accept-encoding': 'gzip, deflate',
  'accept-language': '*',
  connection: 'keep-alive',
  'content-length': '57',
  'content-type': 'application/json',
  host: 'localhost:3000',
  'sec-fetch-mode': 'cors',
  'user-agent': 'node',
  'x-forwarded-for': '127.0.0.1',
  'x-forwarded-host': 'localhost:3000',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'http'
}
=== WooCommerce Inventory Webhook Received ===
Headers: {
  accept: '*/*',
  'accept-encoding': 'gzip, deflate',
  'accept-language': '*',
  connection: 'keep-alive',
  'content-length': '57',
  'content-type': 'application/json',
  host: 'localhost:3000',
  'sec-fetch-mode': 'cors',
  'user-agent': 'node',
  'x-forwarded-for': '127.0.0.1',
  'x-forwarded-host': 'localhost:3000',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'http'
}
=== WooCommerce Inventory Webhook Received ===
Headers: {
  accept: '*/*',
  'accept-encoding': 'gzip, deflate',
  'accept-language': '*',
  connection: 'keep-alive',
  'content-length': '57',
  'content-type': 'application/json',
  host: 'localhost:3000',
  'sec-fetch-mode': 'cors',
  'user-agent': 'node',
  'x-forwarded-for': '127.0.0.1',
  'x-forwarded-host': 'localhost:3000',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'http'
}
=== WooCommerce Inventory Webhook Received ===
Headers: {
  accept: '*/*',
  'accept-encoding': 'gzip, deflate',
  'accept-language': '*',
  connection: 'keep-alive',
  'content-length': '57',
  'content-type': 'application/json',
  host: 'localhost:3000',
  'sec-fetch-mode': 'cors',
  'user-agent': 'node',
  'x-forwarded-for': '127.0.0.1',
  'x-forwarded-host': 'localhost:3000',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'http'
}
=== WooCommerce Inventory Webhook Received ===
Headers: {
  accept: '*/*',
  'accept-encoding': 'gzip, deflate',
  'accept-language': '*',
  connection: 'keep-alive',
  'content-length': '57',
  'content-type': 'application/json',
  host: 'localhost:3000',
  'sec-fetch-mode': 'cors',
  'user-agent': 'node',
  'x-forwarded-for': '127.0.0.1',
  'x-forwarded-host': 'localhost:3000',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'http'
}
=== WooCommerce Inventory Webhook Received ===
Headers: {
  accept: '*/*',
  'accept-encoding': 'gzip, deflate',
  'accept-language': '*',
  connection: 'keep-alive',
  'content-length': '57',
  'content-type': 'application/json',
  host: 'localhost:3000',
  'sec-fetch-mode': 'cors',
  'user-agent': 'node',
  'x-forwarded-for': '127.0.0.1',
  'x-forwarded-host': 'localhost:3000',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'http'
}
Body received, length: 57
Body preview: {"id":2,"name":"Test Product 2","stock_status":"instock"}
Skipping signature verification in development mode
Content-Type: application/json
JSON parsed successfully
Webhook data received: {
  id: 2,
  name: 'Test Product 2',
  slug: undefined,
  stock_status: 'instock',
  stock_quantity: undefined
}
Skipping signature verification for debugging
Webhook topic: product.updated
=== handleProductUpdate called ===
Processing product: product-2 (ID: 2)
Body received, length: 57
Body preview: {"id":3,"name":"Test Product 3","stock_status":"instock"}
Skipping signature verification in development mode
Content-Type: application/json
JSON parsed successfully
Webhook data received: {
  id: 3,
  name: 'Test Product 3',
  slug: undefined,
  stock_status: 'instock',
  stock_quantity: undefined
}
Skipping signature verification for debugging
Webhook topic: product.updated
=== handleProductUpdate called ===
Processing product: product-3 (ID: 3)
Body received, length: 57
Body preview: {"id":4,"name":"Test Product 4","stock_status":"instock"}
Skipping signature verification in development mode
Content-Type: application/json
JSON parsed successfully
Webhook data received: {
  id: 4,
  name: 'Test Product 4',
  slug: undefined,
  stock_status: 'instock',
  stock_quantity: undefined
}
Skipping signature verification for debugging
Webhook topic: product.updated
=== handleProductUpdate called ===
Processing product: product-4 (ID: 4)
Body received, length: 57
Body preview: {"id":5,"name":"Test Product 5","stock_status":"instock"}
Skipping signature verification in development mode
Content-Type: application/json
JSON parsed successfully
Webhook data received: {
  id: 5,
  name: 'Test Product 5',
  slug: undefined,
  stock_status: 'instock',
  stock_quantity: undefined
}
Skipping signature verification for debugging
Webhook topic: product.updated
=== handleProductUpdate called ===
Processing product: product-5 (ID: 5)
Body received, length: 57
Body preview: {"id":6,"name":"Test Product 6","stock_status":"instock"}
Skipping signature verification in development mode
Content-Type: application/json
JSON parsed successfully
Webhook data received: {
  id: 6,
  name: 'Test Product 6',
  slug: undefined,
  stock_status: 'instock',
  stock_quantity: undefined
}
Skipping signature verification for debugging
Webhook topic: product.updated
=== handleProductUpdate called ===
Processing product: product-6 (ID: 6)
Body received, length: 57
Body preview: {"id":7,"name":"Test Product 7","stock_status":"instock"}
Skipping signature verification in development mode
Content-Type: application/json
JSON parsed successfully
Webhook data received: {
  id: 7,
  name: 'Test Product 7',
  slug: undefined,
  stock_status: 'instock',
  stock_quantity: undefined
}
Skipping signature verification for debugging
Webhook topic: product.updated
=== handleProductUpdate called ===
Processing product: product-7 (ID: 7)
Body received, length: 57
Body preview: {"id":8,"name":"Test Product 8","stock_status":"instock"}
Skipping signature verification in development mode
Content-Type: application/json
JSON parsed successfully
Webhook data received: {
  id: 8,
  name: 'Test Product 8',
  slug: undefined,
  stock_status: 'instock',
  stock_quantity: undefined
}
Skipping signature verification for debugging
Webhook topic: product.updated
=== handleProductUpdate called ===
Processing product: product-8 (ID: 8)
Body received, length: 57
Body preview: {"id":9,"name":"Test Product 9","stock_status":"instock"}
Skipping signature verification in development mode
Content-Type: application/json
JSON parsed successfully
Webhook data received: {
  id: 9,
  name: 'Test Product 9',
  slug: undefined,
  stock_status: 'instock',
  stock_quantity: undefined
}
Skipping signature verification for debugging
Webhook topic: product.updated
=== handleProductUpdate called ===
Processing product: product-9 (ID: 9)
Added WooCommerce mapping to Redis: 1 -> product-1
Inventory mapping updated successfully
Added WooCommerce mapping to Redis: 2 -> product-2
Added WooCommerce mapping to Redis: 3 -> product-3
Added WooCommerce mapping to Redis: 4 -> product-4
Added WooCommerce mapping to Redis: 5 -> product-5
Added WooCommerce mapping to Redis: 6 -> product-6
Added WooCommerce mapping to Redis: 7 -> product-7
Added WooCommerce mapping to Redis: 8 -> product-8
Added WooCommerce mapping to Redis: 9 -> product-9
Inventory mapping updated successfully
Inventory mapping updated successfully
Inventory mapping updated successfully
Inventory mapping updated successfully
Inventory mapping updated successfully
Inventory mapping updated successfully
Inventory mapping updated successfully
Inventory mapping updated successfully
Cache updated: product-2 -> instock (0)
Broadcasting stock update: {
  productId: '2',
  stockData: {
    stockStatus: 'instock',
    stockQuantity: undefined,
    availableForSale: true
  }
}
Cache updated: product-3 -> instock (0)
Broadcasting stock update: {
  productId: '3',
  stockData: {
    stockStatus: 'instock',
    stockQuantity: undefined,
    availableForSale: true
  }
}
Cache updated: product-4 -> instock (0)
Broadcasting stock update: {
  productId: '4',
  stockData: {
    stockStatus: 'instock',
    stockQuantity: undefined,
    availableForSale: true
  }
}
Cache updated: product-5 -> instock (0)
Broadcasting stock update: {
  productId: '5',
  stockData: {
    stockStatus: 'instock',
    stockQuantity: undefined,
    availableForSale: true
  }
}
Cache updated: product-6 -> instock (0)
Broadcasting stock update: {
  productId: '6',
  stockData: {
    stockStatus: 'instock',
    stockQuantity: undefined,
    availableForSale: true
  }
}
Cache updated: product-7 -> instock (0)
Broadcasting stock update: {
  productId: '7',
  stockData: {
    stockStatus: 'instock',
    stockQuantity: undefined,
    availableForSale: true
  }
}
Cache updated: product-8 -> instock (0)
Broadcasting stock update: {
  productId: '8',
  stockData: {
    stockStatus: 'instock',
    stockQuantity: undefined,
    availableForSale: true
  }
}
Cache updated: product-9 -> instock (0)
Broadcasting stock update: {
  productId: '9',
  stockData: {
    stockStatus: 'instock',
    stockQuantity: undefined,
    availableForSale: true
  }
}
Cache updated: product-1 -> instock (0)
Broadcasting stock update: {
  productId: '1',
  stockData: {
    stockStatus: 'instock',
    stockQuantity: undefined,
    availableForSale: true
  }
}
Stock update broadcast completed
=== handleProductUpdate completed ===
Stock update broadcast completed
=== handleProductUpdate completed ===
Stock update broadcast completed
=== handleProductUpdate completed ===
Stock update broadcast completed
=== handleProductUpdate completed ===
Stock update broadcast completed
=== handleProductUpdate completed ===
Stock update broadcast completed
=== handleProductUpdate completed ===
Stock update broadcast completed
=== handleProductUpdate completed ===
Stock update broadcast completed
=== handleProductUpdate completed ===
Webhook handled successfully
=== Webhook Processing Complete ===
Webhook handled successfully
=== Webhook Processing Complete ===
Webhook handled successfully
=== Webhook Processing Complete ===
Webhook handled successfully
=== Webhook Processing Complete ===
Webhook handled successfully
=== Webhook Processing Complete ===
Webhook handled successfully
=== Webhook Processing Complete ===
Webhook handled successfully
=== Webhook Processing Complete ===
Webhook handled successfully
=== Webhook Processing Complete ===
 POST /api/webhooks/inventory 200 in 273ms
 POST /api/webhooks/inventory 200 in 272ms
 POST /api/webhooks/inventory 200 in 271ms
 POST /api/webhooks/inventory 200 in 269ms
 POST /api/webhooks/inventory 200 in 269ms
 POST /api/webhooks/inventory 200 in 268ms
 POST /api/webhooks/inventory 200 in 268ms
 POST /api/webhooks/inventory 200 in 267ms
Stock update broadcast completed
=== handleProductUpdate completed ===
Webhook handled successfully
=== Webhook Processing Complete ===
 POST /api/webhooks/inventory 200 in 277ms
=== WooCommerce Inventory Webhook Received ===
Headers: {
  accept: '*/*',
  'accept-encoding': 'gzip, deflate',
  'accept-language': '*',
  connection: 'keep-alive',
  'content-length': '75',
  'content-type': 'application/json',
  host: 'localhost:3000',
  'sec-fetch-mode': 'cors',
  'user-agent': 'node',
  'x-forwarded-for': '::1',
  'x-forwarded-host': 'localhost:3000',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'http',
  'x-wc-webhook-signature': 'test_signature'
}
Body received, length: 75
Body preview: {"id":1,"name":"Test Product","stock_status":"instock","stock_quantity":95}
Skipping signature verification in development mode
Content-Type: application/json
JSON parsed successfully
Webhook data received: {
  id: 1,
  name: 'Test Product',
  slug: undefined,
  stock_status: 'instock',
  stock_quantity: 95
}
Skipping signature verification for debugging
Webhook topic: product.updated
=== handleProductUpdate called ===
Processing product: product-1 (ID: 1)
Added WooCommerce mapping to Redis: 1 -> product-1
Inventory mapping updated successfully
Cache updated: product-1 -> instock (95)
Broadcasting stock update: {
  productId: '1',
  stockData: { stockStatus: 'instock', stockQuantity: 95, availableForSale: true }
}
Stock update broadcast completed
=== handleProductUpdate completed ===
Webhook handled successfully
=== Webhook Processing Complete ===
 POST /api/webhooks/inventory 200 in 171ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 722ms
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
 POST /api/cart 200 in 1427ms
 POST /api/cart 200 in 1428ms
 POST /api/cart 200 in 1430ms
 POST /api/cart 200 in 1432ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 813ms
prisma:query SELECT "public"."product_stocks"."id", "public"."product_stocks"."productId", "public"."product_stocks"."variationId", "public"."product_stocks"."totalStock", "public"."product_stocks"."availableStock", "public"."product_stocks"."reservedStock", "public"."product_stocks"."lastSyncAt", "public"."product_stocks"."syncSource" FROM "public"."product_stocks" WHERE (("public"."product_stocks"."productId" = $1 AND "public"."product_stocks"."variationId" IS NULL) OR ("public"."product_stocks"."productId" = $2 AND "public"."product_stocks"."variationId" IS NULL) OR ("public"."product_stocks"."productId" = $3 AND "public"."product_stocks"."variationId" IS NULL)) OFFSET $4
prisma:query SELECT SUM("quantity") FROM (SELECT "public"."stock_reservations"."quantity" FROM "public"."stock_reservations" WHERE ("public"."stock_reservations"."productId" = $1 AND "public"."stock_reservations"."status" = CAST($2::text AS "public"."ReservationStatus") AND "public"."stock_reservations"."expiresAt" > $3) OFFSET $4) AS "sub"
prisma:query SELECT SUM("quantity") FROM (SELECT "public"."stock_reservations"."quantity" FROM "public"."stock_reservations" WHERE ("public"."stock_reservations"."productId" = $1 AND "public"."stock_reservations"."status" = CAST($2::text AS "public"."ReservationStatus") AND "public"."stock_reservations"."expiresAt" > $3) OFFSET $4) AS "sub"
prisma:query SELECT SUM("quantity") FROM (SELECT "public"."stock_reservations"."quantity" FROM "public"."stock_reservations" WHERE ("public"."stock_reservations"."productId" = $1 AND "public"."stock_reservations"."status" = CAST($2::text AS "public"."ReservationStatus") AND "public"."stock_reservations"."expiresAt" > $3) OFFSET $4) AS "sub"
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
prisma:query ROLLBACK
Error logged: {
  name: 'PrismaClientValidationError',
  message: '\n' +
    'Invalid `prisma.productStock.findUnique()` invocation:\n' +
    '\n' +
    '{\n' +
    '  where: {\n' +
    '    productId_variationId: {\n' +
    '      productId: "1",\n' +
    '+     variationId: String\n' +
    '    }\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Argument `variationId` must not be null.',
  stack: 'PrismaClientValidationError: \n' +
    'Invalid `prisma.productStock.findUnique()` invocation:\n' +
    '\n' +
    '{\n' +
    '  where: {\n' +
    '    productId_variationId: {\n' +
    '      productId: "1",\n' +
    '+     variationId: String\n' +
    '    }\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Argument `variationId` must not be null.\n' +
    '    at _n (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:29:1363)\n' +
    '    at ei.handleRequestError (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6926)\n' +
    '    at ei.handleAndLogRequestError (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6608)\n' +
    '    at ei.request (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6315)\n' +
    '    at async a (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:130:9551)\n' +
    '    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:54:36)\n' +
    '    at async Proxy._transactionWithCallback (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:130:8120)\n' +
    '    at async StockReservationService.createReservation (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:37:20)\n' +
    '    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:245:16)\n' +
    '    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)\n' +
    '    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:244:41)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: { operation: 'create_reservation', productId: '1', quantity: 1 },
  timestamp: '2025-08-13T09:10:06.543Z'
}
Non-operational error detected: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async eval (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:54:36)
    at async Proxy._transactionWithCallback (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:8120)
    at async StockReservationService.createReservation (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:37:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:245:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:244:41)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Unexpected error: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async eval (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:54:36)
    at async Proxy._transactionWithCallback (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:8120)
    at async StockReservationService.createReservation (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:37:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:245:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:244:41)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query BEGIN
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:error 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:error 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
prisma:query ROLLBACK
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query ROLLBACK
Error logged: {
  name: 'PrismaClientValidationError',
  message: '\n' +
    'Invalid `prisma.cartItem.findUnique()` invocation:\n' +
    '\n' +
    '{\n' +
    '  where: {\n' +
    '    cartId_productId_variationId: {\n' +
    '      cartId: "cme9r23110002uv7oexadfee9",\n' +
    '      productId: "1",\n' +
    '+     variationId: String\n' +
    '    }\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Argument `variationId` must not be null.',
  stack: 'PrismaClientValidationError: \n' +
    'Invalid `prisma.cartItem.findUnique()` invocation:\n' +
    '\n' +
    '{\n' +
    '  where: {\n' +
    '    cartId_productId_variationId: {\n' +
    '      cartId: "cme9r23110002uv7oexadfee9",\n' +
    '      productId: "1",\n' +
    '+     variationId: String\n' +
    '    }\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Argument `variationId` must not be null.\n' +
    '    at _n (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:29:1363)\n' +
    '    at ei.handleRequestError (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6926)\n' +
    '    at ei.handleAndLogRequestError (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6608)\n' +
    '    at ei.request (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6315)\n' +
    '    at async a (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:130:9551)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)\n' +
    '    at async Proxy._transactionWithCallback (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:130:8120)\n' +
    '    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)\n' +
    '    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)\n' +
    '    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)\n' +
    '    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    operation: 'add_to_cart',
    cartId: 'cme9r23110002uv7oexadfee9',
    productId: '1'
  },
  timestamp: '2025-08-13T09:10:06.802Z'
}
Non-operational error detected: PrismaClientValidationError: 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)
    at async Proxy._transactionWithCallback (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:8120)
    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Unexpected error: PrismaClientValidationError: 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)
    at async Proxy._transactionWithCallback (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:8120)
    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'PrismaClientValidationError',
  message: '\n' +
    'Invalid `prisma.cartItem.findUnique()` invocation:\n' +
    '\n' +
    '{\n' +
    '  where: {\n' +
    '    cartId_productId_variationId: {\n' +
    '      cartId: "cme9r23110002uv7oexadfee9",\n' +
    '      productId: "1",\n' +
    '+     variationId: String\n' +
    '    }\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Argument `variationId` must not be null.',
  stack: 'PrismaClientValidationError: \n' +
    'Invalid `prisma.cartItem.findUnique()` invocation:\n' +
    '\n' +
    '{\n' +
    '  where: {\n' +
    '    cartId_productId_variationId: {\n' +
    '      cartId: "cme9r23110002uv7oexadfee9",\n' +
    '      productId: "1",\n' +
    '+     variationId: String\n' +
    '    }\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Argument `variationId` must not be null.\n' +
    '    at _n (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:29:1363)\n' +
    '    at ei.handleRequestError (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6926)\n' +
    '    at ei.handleAndLogRequestError (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6608)\n' +
    '    at ei.request (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6315)\n' +
    '    at async a (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:130:9551)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)\n' +
    '    at async Proxy._transactionWithCallback (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:130:8120)\n' +
    '    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)\n' +
    '    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)\n' +
    '    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)\n' +
    '    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:06.803Z'
}
Non-operational error detected: PrismaClientValidationError: 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)
    at async Proxy._transactionWithCallback (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:8120)
    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Unexpected error: PrismaClientValidationError: 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)
    at async Proxy._transactionWithCallback (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:8120)
    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 916ms
Error logged: {
  name: 'PrismaClientValidationError',
  message: '\n' +
    'Invalid `prisma.cartItem.findUnique()` invocation:\n' +
    '\n' +
    '{\n' +
    '  where: {\n' +
    '    cartId_productId_variationId: {\n' +
    '      cartId: "cme9r23110002uv7oexadfee9",\n' +
    '      productId: "1",\n' +
    '+     variationId: String\n' +
    '    }\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Argument `variationId` must not be null.',
  stack: 'PrismaClientValidationError: \n' +
    'Invalid `prisma.cartItem.findUnique()` invocation:\n' +
    '\n' +
    '{\n' +
    '  where: {\n' +
    '    cartId_productId_variationId: {\n' +
    '      cartId: "cme9r23110002uv7oexadfee9",\n' +
    '      productId: "1",\n' +
    '+     variationId: String\n' +
    '    }\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Argument `variationId` must not be null.\n' +
    '    at _n (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:29:1363)\n' +
    '    at ei.handleRequestError (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6926)\n' +
    '    at ei.handleAndLogRequestError (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6608)\n' +
    '    at ei.request (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6315)\n' +
    '    at async a (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:130:9551)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)\n' +
    '    at async Proxy._transactionWithCallback (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:130:8120)\n' +
    '    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)\n' +
    '    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)\n' +
    '    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)\n' +
    '    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    operation: 'add_to_cart',
    cartId: 'cme9r23110002uv7oexadfee9',
    productId: '1'
  },
  timestamp: '2025-08-13T09:10:06.805Z'
}
Non-operational error detected: PrismaClientValidationError: 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)
    at async Proxy._transactionWithCallback (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:8120)
    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Unexpected error: PrismaClientValidationError: 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)
    at async Proxy._transactionWithCallback (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:8120)
    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'PrismaClientValidationError',
  message: '\n' +
    'Invalid `prisma.cartItem.findUnique()` invocation:\n' +
    '\n' +
    '{\n' +
    '  where: {\n' +
    '    cartId_productId_variationId: {\n' +
    '      cartId: "cme9r23110002uv7oexadfee9",\n' +
    '      productId: "1",\n' +
    '+     variationId: String\n' +
    '    }\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Argument `variationId` must not be null.',
  stack: 'PrismaClientValidationError: \n' +
    'Invalid `prisma.cartItem.findUnique()` invocation:\n' +
    '\n' +
    '{\n' +
    '  where: {\n' +
    '    cartId_productId_variationId: {\n' +
    '      cartId: "cme9r23110002uv7oexadfee9",\n' +
    '      productId: "1",\n' +
    '+     variationId: String\n' +
    '    }\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Argument `variationId` must not be null.\n' +
    '    at _n (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:29:1363)\n' +
    '    at ei.handleRequestError (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6926)\n' +
    '    at ei.handleAndLogRequestError (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6608)\n' +
    '    at ei.request (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6315)\n' +
    '    at async a (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:130:9551)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)\n' +
    '    at async Proxy._transactionWithCallback (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:130:8120)\n' +
    '    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)\n' +
    '    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)\n' +
    '    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)\n' +
    '    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:06.805Z'
}
Non-operational error detected: PrismaClientValidationError: 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)
    at async Proxy._transactionWithCallback (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:8120)
    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Unexpected error: PrismaClientValidationError: 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)
    at async Proxy._transactionWithCallback (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:8120)
    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 917ms
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:error 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
prisma:query ROLLBACK
Error logged: {
  name: 'PrismaClientValidationError',
  message: '\n' +
    'Invalid `prisma.cartItem.findUnique()` invocation:\n' +
    '\n' +
    '{\n' +
    '  where: {\n' +
    '    cartId_productId_variationId: {\n' +
    '      cartId: "cme9r23110002uv7oexadfee9",\n' +
    '      productId: "1",\n' +
    '+     variationId: String\n' +
    '    }\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Argument `variationId` must not be null.',
  stack: 'PrismaClientValidationError: \n' +
    'Invalid `prisma.cartItem.findUnique()` invocation:\n' +
    '\n' +
    '{\n' +
    '  where: {\n' +
    '    cartId_productId_variationId: {\n' +
    '      cartId: "cme9r23110002uv7oexadfee9",\n' +
    '      productId: "1",\n' +
    '+     variationId: String\n' +
    '    }\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Argument `variationId` must not be null.\n' +
    '    at _n (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:29:1363)\n' +
    '    at ei.handleRequestError (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6926)\n' +
    '    at ei.handleAndLogRequestError (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6608)\n' +
    '    at ei.request (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6315)\n' +
    '    at async a (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:130:9551)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)\n' +
    '    at async Proxy._transactionWithCallback (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:130:8120)\n' +
    '    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)\n' +
    '    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)\n' +
    '    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)\n' +
    '    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    operation: 'add_to_cart',
    cartId: 'cme9r23110002uv7oexadfee9',
    productId: '1'
  },
  timestamp: '2025-08-13T09:10:07.009Z'
}
Non-operational error detected: PrismaClientValidationError: 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)
    at async Proxy._transactionWithCallback (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:8120)
    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Unexpected error: PrismaClientValidationError: 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)
    at async Proxy._transactionWithCallback (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:8120)
    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'PrismaClientValidationError',
  message: '\n' +
    'Invalid `prisma.cartItem.findUnique()` invocation:\n' +
    '\n' +
    '{\n' +
    '  where: {\n' +
    '    cartId_productId_variationId: {\n' +
    '      cartId: "cme9r23110002uv7oexadfee9",\n' +
    '      productId: "1",\n' +
    '+     variationId: String\n' +
    '    }\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Argument `variationId` must not be null.',
  stack: 'PrismaClientValidationError: \n' +
    'Invalid `prisma.cartItem.findUnique()` invocation:\n' +
    '\n' +
    '{\n' +
    '  where: {\n' +
    '    cartId_productId_variationId: {\n' +
    '      cartId: "cme9r23110002uv7oexadfee9",\n' +
    '      productId: "1",\n' +
    '+     variationId: String\n' +
    '    }\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Argument `variationId` must not be null.\n' +
    '    at _n (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:29:1363)\n' +
    '    at ei.handleRequestError (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6926)\n' +
    '    at ei.handleAndLogRequestError (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6608)\n' +
    '    at ei.request (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:121:6315)\n' +
    '    at async a (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:130:9551)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)\n' +
    '    at async Proxy._transactionWithCallback (E:\\ankkorwoo\\ankkor\\node_modules\\@prisma\\client\\runtime\\library.js:130:8120)\n' +
    '    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)\n' +
    '    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)\n' +
    '    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)\n' +
    '    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:07.010Z'
}
Non-operational error detected: PrismaClientValidationError: 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)
    at async Proxy._transactionWithCallback (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:8120)
    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Unexpected error: PrismaClientValidationError: 
Invalid `prisma.cartItem.findUnique()` invocation:

{
  where: {
    cartId_productId_variationId: {
      cartId: "cme9r23110002uv7oexadfee9",
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async eval (webpack-internal:///(rsc)/./src/services/CartService.ts:77:34)
    at async Proxy._transactionWithCallback (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:8120)
    at async CartService.addToCart (webpack-internal:///(rsc)/./src/services/CartService.ts:63:16)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:256:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:255:50)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 1123ms
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query COMMIT
prisma:query COMMIT
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
 POST /api/cart 200 in 609ms
 POST /api/cart 200 in 612ms
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
 POST /api/cart 200 in 813ms
 POST /api/cart 200 in 814ms
 POST /api/cart 200 in 815ms
prisma:query SELECT "public"."product_stocks"."id", "public"."product_stocks"."productId", "public"."product_stocks"."variationId", "public"."product_stocks"."totalStock", "public"."product_stocks"."availableStock", "public"."product_stocks"."reservedStock", "public"."product_stocks"."lastSyncAt", "public"."product_stocks"."syncSource" FROM "public"."product_stocks" WHERE (("public"."product_stocks"."productId" = $1 AND "public"."product_stocks"."variationId" IS NULL) OR ("public"."product_stocks"."productId" = $2 AND "public"."product_stocks"."variationId" IS NULL)) OFFSET $3
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "2",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "2",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 20, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 20, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:07.861Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 27ms
prisma:query SELECT "public"."product_stocks"."id", "public"."product_stocks"."productId", "public"."product_stocks"."variationId", "public"."product_stocks"."totalStock", "public"."product_stocks"."availableStock", "public"."product_stocks"."reservedStock", "public"."product_stocks"."lastSyncAt", "public"."product_stocks"."syncSource" FROM "public"."product_stocks" WHERE (("public"."product_stocks"."productId" = $1 AND "public"."product_stocks"."variationId" IS NULL) OR ("public"."product_stocks"."productId" = $2 AND "public"."product_stocks"."variationId" IS NULL)) OFFSET $3
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 20, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 20, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:13.357Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 5524ms
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 20, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 20, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:13.359Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 5526ms
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 20, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 20, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:13.361Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 5732ms
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 20, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 20, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:13.363Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 5730ms
Error logged: {
  name: 'ZodError',
  message: '[\n' +
    '  {\n' +
    '    "code": "invalid_type",\n' +
    '    "expected": "string",\n' +
    '    "received": "undefined",\n' +
    '    "path": [\n' +
    '      "productId"\n' +
    '    ],\n' +
    '    "message": "Required"\n' +
    '  },\n' +
    '  {\n' +
    '    "code": "too_small",\n' +
    '    "minimum": 0,\n' +
    '    "type": "number",\n' +
    '    "inclusive": false,\n' +
    '    "exact": false,\n' +
    '    "message": "Quantity must be a positive integer",\n' +
    '    "path": [\n' +
    '      "quantity"\n' +
    '    ]\n' +
    '  },\n' +
    '  {\n' +
    '    "code": "invalid_type",\n' +
    '    "expected": "number",\n' +
    '    "received": "string",\n' +
    '    "path": [\n' +
    '      "price"\n' +
    '    ],\n' +
    '    "message": "Expected number, received string"\n' +
    '  },\n' +
    '  {\n' +
    '    "code": "invalid_type",\n' +
    '    "expected": "string",\n' +
    '    "received": "undefined",\n' +
    '    "path": [\n' +
    '      "name"\n' +
    '    ],\n' +
    '    "message": "Required"\n' +
    '  }\n' +
    ']',
  stack: 'ZodError: [\n' +
    '  {\n' +
    '    "code": "invalid_type",\n' +
    '    "expected": "string",\n' +
    '    "received": "undefined",\n' +
    '    "path": [\n' +
    '      "productId"\n' +
    '    ],\n' +
    '    "message": "Required"\n' +
    '  },\n' +
    '  {\n' +
    '    "code": "too_small",\n' +
    '    "minimum": 0,\n' +
    '    "type": "number",\n' +
    '    "inclusive": false,\n' +
    '    "exact": false,\n' +
    '    "message": "Quantity must be a positive integer",\n' +
    '    "path": [\n' +
    '      "quantity"\n' +
    '    ]\n' +
    '  },\n' +
    '  {\n' +
    '    "code": "invalid_type",\n' +
    '    "expected": "number",\n' +
    '    "received": "string",\n' +
    '    "path": [\n' +
    '      "price"\n' +
    '    ],\n' +
    '    "message": "Expected number, received string"\n' +
    '  },\n' +
    '  {\n' +
    '    "code": "invalid_type",\n' +
    '    "expected": "string",\n' +
    '    "received": "undefined",\n' +
    '    "path": [\n' +
    '      "name"\n' +
    '    ],\n' +
    '    "message": "Required"\n' +
    '  }\n' +
    ']\n' +
    '    at get error [as error] (webpack-internal:///(rsc)/./node_modules/zod/lib/index.mjs:699:31)\n' +
    '    at ZodObject.parse (webpack-internal:///(rsc)/./node_modules/zod/lib/index.mjs:775:22)\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:227:43)\n' +
    '    at eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:26)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:13.377Z'
}
Non-operational error detected: ZodError: [
  {
    "code": "invalid_type",
    "expected": "string",
    "received": "undefined",
    "path": [
      "productId"
    ],
    "message": "Required"
  },
  {
    "code": "too_small",
    "minimum": 0,
    "type": "number",
    "inclusive": false,
    "exact": false,
    "message": "Quantity must be a positive integer",
    "path": [
      "quantity"
    ]
  },
  {
    "code": "invalid_type",
    "expected": "number",
    "received": "string",
    "path": [
      "price"
    ],
    "message": "Expected number, received string"
  },
  {
    "code": "invalid_type",
    "expected": "string",
    "received": "undefined",
    "path": [
      "name"
    ],
    "message": "Required"
  }
]
    at get error [as error] (webpack-internal:///(rsc)/./node_modules/zod/lib/index.mjs:699:31)
    at ZodObject.parse (webpack-internal:///(rsc)/./node_modules/zod/lib/index.mjs:775:22)
    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:227:43)
    at eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:26)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  issues: [
    {
      code: 'invalid_type',
      expected: 'string',
      received: 'undefined',
      path: [Array],
      message: 'Required'
    },
    {
      code: 'too_small',
      minimum: 0,
      type: 'number',
      inclusive: false,
      exact: false,
      message: 'Quantity must be a positive integer',
      path: [Array]
    },
    {
      code: 'invalid_type',
      expected: 'number',
      received: 'string',
      path: [Array],
      message: 'Expected number, received string'
    },
    {
      code: 'invalid_type',
      expected: 'string',
      received: 'undefined',
      path: [Array],
      message: 'Required'
    }
  ],
  addIssue: [Function (anonymous)],
  addIssues: [Function (anonymous)],
  errors: [
    {
      code: 'invalid_type',
      expected: 'string',
      received: 'undefined',
      path: [Array],
      message: 'Required'
    },
    {
      code: 'too_small',
      minimum: 0,
      type: 'number',
      inclusive: false,
      exact: false,
      message: 'Quantity must be a positive integer',
      path: [Array]
    },
    {
      code: 'invalid_type',
      expected: 'number',
      received: 'string',
      path: [Array],
      message: 'Expected number, received string'
    },
    {
      code: 'invalid_type',
      expected: 'string',
      received: 'undefined',
      path: [Array],
      message: 'Required'
    }
  ]
}
Unexpected error: ZodError: [
  {
    "code": "invalid_type",
    "expected": "string",
    "received": "undefined",
    "path": [
      "productId"
    ],
    "message": "Required"
  },
  {
    "code": "too_small",
    "minimum": 0,
    "type": "number",
    "inclusive": false,
    "exact": false,
    "message": "Quantity must be a positive integer",
    "path": [
      "quantity"
    ]
  },
  {
    "code": "invalid_type",
    "expected": "number",
    "received": "string",
    "path": [
      "price"
    ],
    "message": "Expected number, received string"
  },
  {
    "code": "invalid_type",
    "expected": "string",
    "received": "undefined",
    "path": [
      "name"
    ],
    "message": "Required"
  }
]
    at get error [as error] (webpack-internal:///(rsc)/./node_modules/zod/lib/index.mjs:699:31)
    at ZodObject.parse (webpack-internal:///(rsc)/./node_modules/zod/lib/index.mjs:775:22)
    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:227:43)
    at eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:26)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  issues: [
    {
      code: 'invalid_type',
      expected: 'string',
      received: 'undefined',
      path: [Array],
      message: 'Required'
    },
    {
      code: 'too_small',
      minimum: 0,
      type: 'number',
      inclusive: false,
      exact: false,
      message: 'Quantity must be a positive integer',
      path: [Array]
    },
    {
      code: 'invalid_type',
      expected: 'number',
      received: 'string',
      path: [Array],
      message: 'Expected number, received string'
    },
    {
      code: 'invalid_type',
      expected: 'string',
      received: 'undefined',
      path: [Array],
      message: 'Required'
    }
  ],
  addIssue: [Function (anonymous)],
  addIssues: [Function (anonymous)],
  errors: [
    {
      code: 'invalid_type',
      expected: 'string',
      received: 'undefined',
      path: [Array],
      message: 'Required'
    },
    {
      code: 'too_small',
      minimum: 0,
      type: 'number',
      inclusive: false,
      exact: false,
      message: 'Quantity must be a positive integer',
      path: [Array]
    },
    {
      code: 'invalid_type',
      expected: 'number',
      received: 'string',
      path: [Array],
      message: 'Expected number, received string'
    },
    {
      code: 'invalid_type',
      expected: 'string',
      received: 'undefined',
      path: [Array],
      message: 'Required'
    }
  ]
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 12ms
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
Error logged: {
  name: 'NotFoundError',
  message: 'Cart not found',
  stack: 'NotFoundError: Cart not found\n' +
    '    at eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:64:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart?cartId=nonexistent_cart_1755076213379',
    method: 'GET',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:13.663Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 GET /api/cart?cartId=nonexistent_cart_1755076213379 500 in 283ms
Error logged: {
  name: 'ValidationError',
  message: 'Invalid action. Supported actions: create_cart, add_item, merge_guest_cart',
  stack: 'ValidationError: Invalid action. Supported actions: create_cart, add_item, merge_guest_cart\n' +
    '    at eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:114:19)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:13.678Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 700ms
Error logged: {
  name: 'ZodError',
  message: '[\n' +
    '  {\n' +
    '    "code": "too_big",\n' +
    '    "maximum": 100,\n' +
    '    "type": "number",\n' +
    '    "inclusive": true,\n' +
    '    "exact": false,\n' +
    '    "message": "Maximum quantity is 100",\n' +
    '    "path": [\n' +
    '      "quantity"\n' +
    '    ]\n' +
    '  }\n' +
    ']',
  stack: 'ZodError: [\n' +
    '  {\n' +
    '    "code": "too_big",\n' +
    '    "maximum": 100,\n' +
    '    "type": "number",\n' +
    '    "inclusive": true,\n' +
    '    "exact": false,\n' +
    '    "message": "Maximum quantity is 100",\n' +
    '    "path": [\n' +
    '      "quantity"\n' +
    '    ]\n' +
    '  }\n' +
    ']\n' +
    '    at get error [as error] (webpack-internal:///(rsc)/./node_modules/zod/lib/index.mjs:699:31)\n' +
    '    at ZodObject.parse (webpack-internal:///(rsc)/./node_modules/zod/lib/index.mjs:775:22)\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:227:43)\n' +
    '    at eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:26)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:14.391Z'
}
Non-operational error detected: ZodError: [
  {
    "code": "too_big",
    "maximum": 100,
    "type": "number",
    "inclusive": true,
    "exact": false,
    "message": "Maximum quantity is 100",
    "path": [
      "quantity"
    ]
  }
]
    at get error [as error] (webpack-internal:///(rsc)/./node_modules/zod/lib/index.mjs:699:31)
    at ZodObject.parse (webpack-internal:///(rsc)/./node_modules/zod/lib/index.mjs:775:22)
    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:227:43)
    at eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:26)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  issues: [
    {
      code: 'too_big',
      maximum: 100,
      type: 'number',
      inclusive: true,
      exact: false,
      message: 'Maximum quantity is 100',
      path: [Array]
    }
  ],
  addIssue: [Function (anonymous)],
  addIssues: [Function (anonymous)],
  errors: [
    {
      code: 'too_big',
      maximum: 100,
      type: 'number',
      inclusive: true,
      exact: false,
      message: 'Maximum quantity is 100',
      path: [Array]
    }
  ]
}
Unexpected error: ZodError: [
  {
    "code": "too_big",
    "maximum": 100,
    "type": "number",
    "inclusive": true,
    "exact": false,
    "message": "Maximum quantity is 100",
    "path": [
      "quantity"
    ]
  }
]
    at get error [as error] (webpack-internal:///(rsc)/./node_modules/zod/lib/index.mjs:699:31)
    at ZodObject.parse (webpack-internal:///(rsc)/./node_modules/zod/lib/index.mjs:775:22)
    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:227:43)
    at eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:26)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  issues: [
    {
      code: 'too_big',
      maximum: 100,
      type: 'number',
      inclusive: true,
      exact: false,
      message: 'Maximum quantity is 100',
      path: [Array]
    }
  ],
  addIssue: [Function (anonymous)],
  addIssues: [Function (anonymous)],
  errors: [
    {
      code: 'too_big',
      maximum: 100,
      type: 'number',
      inclusive: true,
      exact: false,
      message: 'Maximum quantity is 100',
      path: [Array]
    }
  ]
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 10ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 704ms
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
 POST /api/cart 200 in 601ms
 POST /api/cart 200 in 593ms
 POST /api/cart 200 in 605ms
 POST /api/cart 200 in 606ms
 POST /api/cart 200 in 599ms
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query BEGIN
prisma:query BEGIN
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
 POST /api/cart 200 in 1196ms
 POST /api/cart 200 in 1198ms
 POST /api/cart 200 in 1199ms
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
prisma:query COMMIT
 POST /api/cart 200 in 1819ms
 POST /api/cart 200 in 1815ms
 POST /api/cart 200 in 1815ms
 POST /api/cart 200 in 1822ms
 POST /api/cart 200 in 1819ms
 POST /api/cart 200 in 1822ms
 POST /api/cart 200 in 1824ms
 POST /api/cart 200 in 1825ms
 POST /api/cart 200 in 1826ms
 POST /api/cart 200 in 1826ms
 POST /api/cart 200 in 1829ms
 POST /api/cart 200 in 1825ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 599ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:17.567Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 600ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:18.183Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 12ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 601ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:18.798Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 598ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:19.414Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 14ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 597ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:20.028Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 12ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 597ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:20.639Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 805ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:21.459Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 609ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:22.081Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 592ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:22.688Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 614ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:23.318Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 10ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 585ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:23.919Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 12ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 696ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:24.634Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 13ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 700ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:25.353Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 15ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 599ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:25.967Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 12ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 699ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:26.684Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 13ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 595ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:27.298Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 12ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 698ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:28.011Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 10ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 591ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:28.618Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 12ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 598ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:29.230Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 10ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 601ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:29.845Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 701ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:30.566Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 15ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 643ms
prisma:query SELECT 1
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:31.369Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 156ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 612ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:32.003Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 17ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 689ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:32.709Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 603ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:33.326Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 12ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 601ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:33.943Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 13ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 700ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:34.660Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 13ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 599ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:35.274Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 597ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:35.887Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 599ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:36.501Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 599ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:37.115Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 12ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 599ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:37.731Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 12ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 597ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:38.344Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 10ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 602ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:38.961Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 701ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:39.676Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 612ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:40.303Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 587ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:40.905Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 601ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:41.520Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 599ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:42.134Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 12ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 598ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:42.748Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 12ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 701ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:43.464Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 10ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 719ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:44.198Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 687ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:44.901Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 13ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 606ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:45.521Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 10ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 697ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:46.234Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 13ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 802ms
prisma:query SELECT 1
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:47.141Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 100ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 611ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:47.766Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 599ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:48.381Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 12ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 704ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:49.101Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 10ms
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 593ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 1, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 1, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:10:49.710Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 11ms
prisma:query SELECT 1
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 681ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 2, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 2, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:11:35.768Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 18ms
prisma:query SELECT 1
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) ORDER BY "public"."cart_items"."createdAt" ASC OFFSET $2
 GET /api/cart?sessionId=test-session-123 200 in 1304ms
prisma:query SELECT 1
prisma:query BEGIN
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE ("public"."carts"."sessionId" = $1 AND "public"."carts"."status" = CAST($2::text AS "public"."CartStatus")) LIMIT $3 OFFSET $4
prisma:query INSERT INTO "public"."carts" ("id","sessionId","status","createdAt","updatedAt","expiresAt") VALUES ($1,$2,CAST($3::text AS "public"."CartStatus"),$4,$5,$6) RETURNING "public"."carts"."id"
prisma:query SELECT "public"."carts"."id", "public"."carts"."userId", "public"."carts"."sessionId", "public"."carts"."status"::text, "public"."carts"."createdAt", "public"."carts"."updatedAt", "public"."carts"."expiresAt", "public"."carts"."convertedAt" FROM "public"."carts" WHERE "public"."carts"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."cart_items"."id", "public"."cart_items"."cartId", "public"."cart_items"."productId", "public"."cart_items"."variationId", "public"."cart_items"."quantity", "public"."cart_items"."price", "public"."cart_items"."name", "public"."cart_items"."imageUrl", "public"."cart_items"."attributes", "public"."cart_items"."reservationId", "public"."cart_items"."createdAt", "public"."cart_items"."updatedAt" FROM "public"."cart_items" WHERE "public"."cart_items"."cartId" IN ($1) OFFSET $2
prisma:query COMMIT
 POST /api/cart 200 in 732ms
prisma:error 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
Error checking available stock: PrismaClientValidationError: 
Invalid `prisma.productStock.findUnique()` invocation:

{
  where: {
    productId_variationId: {
      productId: "1",
+     variationId: String
    }
  }
}

Argument `variationId` must not be null.
    at _n (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:29:1363)
    at ei.handleRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6926)
    at ei.handleAndLogRequestError (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6608)
    at ei.request (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:121:6315)
    at async a (E:\ankkorwoo\ankkor\node_modules\@prisma\client\runtime\library.js:130:9551)
    at async StockReservationService.checkAvailableStockInternal (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:204:30)
    at async StockReservationService.checkAvailableStock (webpack-internal:///(rsc)/./src/services/StockReservationService.ts:187:20)
    at async operation (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:230:16)
    at async safeAsync (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:262:22)
    at async handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:229:54)
    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)
    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13) {
  clientVersion: '6.14.0'
}
Error logged: {
  name: 'StockError',
  message: 'Insufficient stock available. Requested: 2, Available: 0',
  stack: 'StockError: Insufficient stock available. Requested: 2, Available: 0\n' +
    '    at handleAddItem (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:240:15)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/app/api/cart/route.ts:110:20)\n' +
    '    at async eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:303:20)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\compiled\\next-server\\app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\base-server.js:818:17)\n' +
    '    at async E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\trace\\trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\dev\\next-dev-server.js:336:24)\n' +
    '    at async invokeRender (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:178:21)\n' +
    '    at async handleRequest (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\router-server.js:379:13)\n' +
    '    at async Server.requestListener (E:\\ankkorwoo\\ankkor\\node_modules\\next\\dist\\server\\lib\\start-server.js:141:13)',
  context: {
    url: 'http://localhost:3000/api/cart',
    method: 'POST',
    userAgent: undefined
  },
  timestamp: '2025-08-13T09:14:05.213Z'
}
 ⨯ TypeError: res.status is not a function
    at eval (webpack-internal:///(rsc)/./src/lib/errorHandling.ts:312:24)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:57228
    at async eT.execute (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:46851)
    at async eT.handle (E:\ankkorwoo\ankkor\node_modules\next\dist\compiled\next-server\app-route.runtime.dev.js:6:58760)
    at async doRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1496:28)
    at async DevServer.renderPageComponent (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:1962:32)
    at async DevServer.pipeImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\next-server.js:272:17)
    at async DevServer.handleRequestImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\base-server.js:818:17)
    at async E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:339:20
    at async Span.traceAsyncFn (E:\ankkorwoo\ankkor\node_modules\next\dist\trace\trace.js:154:20)
    at async DevServer.handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\dev\next-dev-server.js:336:24)
    at async invokeRender (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:178:21)
    at async handleRequest (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:355:24)
    at async requestHandlerImpl (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\router-server.js:379:13)
    at async Server.requestListener (E:\ankkorwoo\ankkor\node_modules\next\dist\server\lib\start-server.js:141:13)
 POST /api/cart 500 in 16ms
 ✓ Compiled /_not-found in 331ms (762 modules)
 GET /workspace/okr-dashboard 404 in 594ms
 ⚠ The "images.domains" configuration is deprecated. Please use "images.remotePatterns" configuration instead.
 ○ Compiling /api/auth/me ...
 ✓ Compiled /api/auth/me in 625ms (771 modules)
 ✓ Compiled /api/graphql in 196ms (773 modules)
🔗 GraphQL Proxy - Using endpoint: https://maroon-lapwing-781450.hostingersite.com/graphql
📊 GraphQL Proxy - Request body: {
  "query": "\n      query GetProductById($id: ID!) {\n        product(id: $id, idType: DATABASE_ID) {\n          id\n          databaseId\n          name\n          slug\n          description\n          shortDescription\n          productCategories {\n            nodes {\n              id\n              name\n              slug\n            }\n          }\n          ... on SimpleProduct {\n            price\n            regularPrice\n            salePrice\n            onSale\n            stockStatus\n            stockQuantity\n          }\n          ... on VariableProduct {\n            price\n            regularPrice\n            salePrice\n            onSale\n            stockStatus\n            variations {\n              nodes {\n                stockStatus\n                stockQuantity\n              }\n            }\n          }\n          image {\n            id\n            sourceUrl\n            altText\n          }\n        }\n      }\n    ",
  "variables": {
    "id": "cG9zdDo2Mg=="
  }
}
📏 GraphQL Proxy - Incoming cookie size: 10152
📏 GraphQL Proxy - Incoming session size: 0
⚠️ GraphQL Proxy - Cookie header too large, skipping
🔗 GraphQL Proxy - Using endpoint: https://maroon-lapwing-781450.hostingersite.com/graphql
📊 GraphQL Proxy - Request body: {
  "query": "\n      query GetProductById($id: ID!) {\n        product(id: $id, idType: DATABASE_ID) {\n          id\n          databaseId\n          name\n          slug\n          description\n          shortDescription\n          productCategories {\n            nodes {\n              id\n              name\n              slug\n            }\n          }\n          ... on SimpleProduct {\n            price\n            regularPrice\n            salePrice\n            onSale\n            stockStatus\n            stockQuantity\n          }\n          ... on VariableProduct {\n            price\n            regularPrice\n            salePrice\n            onSale\n            stockStatus\n            variations {\n              nodes {\n                stockStatus\n                stockQuantity\n              }\n            }\n          }\n          image {\n            id\n            sourceUrl\n            altText\n          }\n        }\n      }\n    ",
  "variables": {
    "id": "cG9zdDo2Mg=="
  }
}
📏 GraphQL Proxy - Incoming cookie size: 10152
📏 GraphQL Proxy - Incoming session size: 0
⚠️ GraphQL Proxy - Cookie header too large, skipping
 GET /api/auth/me 401 in 1369ms
 GET /api/auth/me 401 in 36ms
 ✓ Compiled /api/auth in 215ms (775 modules)
 POST /api/auth 400 in 271ms
 POST /api/auth 400 in 307ms
 GET /api/auth/me 401 in 12ms
 GET /api/auth/me 401 in 12ms
🔄 GraphQL Proxy - Response status: 200
🔄 GraphQL Proxy - Response headers: {
  'access-control-allow-headers': 'Authorization, Content-Type, X-JWT-Auth, X-JWT-Refresh, woocommerce-session',
  'access-control-allow-origin': '*',
  'access-control-expose-headers': 'X-JWT-Refresh, woocommerce-session',
  'access-control-max-age': '600',
  'cache-control': 'no-cache, no-store, must-revalidate, max-age=0',
  connection: 'keep-alive',
  'content-encoding': 'br',
  'content-security-policy': 'upgrade-insecure-requests',
  'content-type': 'application/json; charset=UTF-8',
  date: 'Wed, 13 Aug 2025 09:14:36 GMT',
  panel: 'hpanel',
  platform: 'hostinger',
  server: 'hcdn',
  'transfer-encoding': 'chunked',
  vary: 'Accept-Encoding',
  'woocommerce-session': 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwczovL21hcm9vbi1sYXB3aW5nLTc4MTQ1MC5ob3N0aW5nZXJzaXRlLmNvbSIsImlhdCI6MTc1NTA3NjQ3NSwibmJmIjoxNzU1MDc2NDc1LCJleHAiOjE3NTUyNDkyNzUsImRhdGEiOnsiY3VzdG9tZXJfaWQiOiJ0XzEwZTdkOWFmNjgyYjJjM2M0NzkyYmEzZjM4NGI5MSJ9fQ.H0G74PCntmnecDZG0JirtunBH1sYu4__qXhfEvVdwI8',
  'x-content-type-options': 'nosniff',
  'x-graphql-url': 'maroon-lapwing-781450.hostingersite.com/graphql',
  'x-hcdn-cache-status': 'DYNAMIC',
  'x-hcdn-request-id': '5bfe5e41afa54e8c6854b1cfafee42b2-mum-edge8',
  'x-hcdn-upstream-rt': '0.877',
  'x-litespeed-cache-control': 'no-cache',
  'x-powered-by': 'PHP/8.2.28',
  'x-robots-tag': 'noindex'
}
📄 GraphQL Proxy - Content-Type: application/json; charset=UTF-8
✅ GraphQL Proxy - Response data: {
  "errors": [
    {
      "message": "No product ID was found corresponding to the database_id: cG9zdDo2Mg==",
      "locations": [
        {
          "line": 3,
          "column": 9
        }
      ],
      "path": [
        "product"
      ]
    }
  ],
  "data": {
    "product": null
  },
  "extensions": {
    "debug": [
      {
        "type": "DEBUG_LOGS_INACTIVE",
        "message": "GraphQL Debug logging is not active. To see debug logs, GRAPHQL_DEBUG must be enabled."
      }
    ]
  }
}
 POST /api/graphql 200 in 2071ms
🔄 GraphQL Proxy - Response status: 200
🔄 GraphQL Proxy - Response headers: {
  'access-control-allow-headers': 'Authorization, Content-Type, X-JWT-Auth, X-JWT-Refresh, woocommerce-session',
  'access-control-allow-origin': '*',
  'access-control-expose-headers': 'X-JWT-Refresh, woocommerce-session',
  'access-control-max-age': '600',
  'cache-control': 'no-cache, no-store, must-revalidate, max-age=0',
  connection: 'keep-alive',
  'content-encoding': 'br',
  'content-security-policy': 'upgrade-insecure-requests',
  'content-type': 'application/json; charset=UTF-8',
  date: 'Wed, 13 Aug 2025 09:14:36 GMT',
  panel: 'hpanel',
  platform: 'hostinger',
  server: 'hcdn',
  'transfer-encoding': 'chunked',
  vary: 'Accept-Encoding',
  'woocommerce-session': 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwczovL21hcm9vbi1sYXB3aW5nLTc4MTQ1MC5ob3N0aW5nZXJzaXRlLmNvbSIsImlhdCI6MTc1NTA3NjQ3NSwibmJmIjoxNzU1MDc2NDc1LCJleHAiOjE3NTUyNDkyNzUsImRhdGEiOnsiY3VzdG9tZXJfaWQiOiJ0XzcxZmQwNjNiNDI2OTVhZTkxYmYxOWUxMzc3NTU4NiJ9fQ.IXhCvnWcGQ8gKAjQo8LXaGBSh3U2ikfAmCWMO6dhpBM',
  'x-content-type-options': 'nosniff',
  'x-graphql-url': 'maroon-lapwing-781450.hostingersite.com/graphql',
  'x-hcdn-cache-status': 'DYNAMIC',
  'x-hcdn-request-id': 'b7327715401066fbe6264636ab37ac0f-mum-edge5',
  'x-hcdn-upstream-rt': '0.897',
  'x-litespeed-cache-control': 'no-cache',
  'x-powered-by': 'PHP/8.2.28',
  'x-robots-tag': 'noindex'
}
📄 GraphQL Proxy - Content-Type: application/json; charset=UTF-8
✅ GraphQL Proxy - Response data: {
  "errors": [
    {
      "message": "No product ID was found corresponding to the database_id: cG9zdDo2Mg==",
      "locations": [
        {
          "line": 3,
          "column": 9
        }
      ],
      "path": [
        "product"
      ]
    }
  ],
  "data": {
    "product": null
  },
  "extensions": {
    "debug": [
      {
        "type": "DEBUG_LOGS_INACTIVE",
        "message": "GraphQL Debug logging is not active. To see debug logs, GRAPHQL_DEBUG must be enabled."
      }
    ]
  }
}
 POST /api/graphql 200 in 2081ms
 GET /workspace/okr-dashboard 404 in 145ms
 GET /api/auth/me 401 in 27ms
 GET /api/auth/me 401 in 25ms
 POST /api/auth 400 in 22ms
 POST /api/auth 400 in 45ms
 GET /api/auth/me 401 in 50ms
 GET /api/auth/me 401 in 38ms
🔗 GraphQL Proxy - Using endpoint: https://maroon-lapwing-781450.hostingersite.com/graphql
📊 GraphQL Proxy - Request body: {
  "query": "\n      query GetProductById($id: ID!) {\n        product(id: $id, idType: DATABASE_ID) {\n          id\n          databaseId\n          name\n          slug\n          description\n          shortDescription\n          productCategories {\n            nodes {\n              id\n              name\n              slug\n            }\n          }\n          ... on SimpleProduct {\n            price\n            regularPrice\n            salePrice\n            onSale\n            stockStatus\n            stockQuantity\n          }\n          ... on VariableProduct {\n            price\n            regularPrice\n            salePrice\n            onSale\n            stockStatus\n            variations {\n              nodes {\n                stockStatus\n                stockQuantity\n              }\n            }\n          }\n          image {\n            id\n            sourceUrl\n            altText\n          }\n        }\n      }\n    ",
  "variables": {
    "id": "cG9zdDo2Mg=="
  }
}
📏 GraphQL Proxy - Incoming cookie size: 10152
📏 GraphQL Proxy - Incoming session size: 311
⚠️ GraphQL Proxy - Cookie header too large, skipping
🔗 GraphQL Proxy - Using endpoint: https://maroon-lapwing-781450.hostingersite.com/graphql
📊 GraphQL Proxy - Request body: {
  "query": "\n      query GetProductById($id: ID!) {\n        product(id: $id, idType: DATABASE_ID) {\n          id\n          databaseId\n          name\n          slug\n          description\n          shortDescription\n          productCategories {\n            nodes {\n              id\n              name\n              slug\n            }\n          }\n          ... on SimpleProduct {\n            price\n            regularPrice\n            salePrice\n            onSale\n            stockStatus\n            stockQuantity\n          }\n          ... on VariableProduct {\n            price\n            regularPrice\n            salePrice\n            onSale\n            stockStatus\n            variations {\n              nodes {\n                stockStatus\n                stockQuantity\n              }\n            }\n          }\n          image {\n            id\n            sourceUrl\n            altText\n          }\n        }\n      }\n    ",
  "variables": {
    "id": "cG9zdDo2Mg=="
  }
}
📏 GraphQL Proxy - Incoming cookie size: 10152
📏 GraphQL Proxy - Incoming session size: 311
⚠️ GraphQL Proxy - Cookie header too large, skipping
🔄 GraphQL Proxy - Response status: 200
🔄 GraphQL Proxy - Response headers: {
  'access-control-allow-headers': 'Authorization, Content-Type, X-JWT-Auth, X-JWT-Refresh, woocommerce-session',
  'access-control-allow-origin': '*',
  'access-control-expose-headers': 'X-JWT-Refresh, woocommerce-session',
  'access-control-max-age': '600',
  'cache-control': 'no-cache, no-store, must-revalidate, max-age=0',
  connection: 'keep-alive',
  'content-encoding': 'br',
  'content-security-policy': 'upgrade-insecure-requests',
  'content-type': 'application/json; charset=UTF-8',
  date: 'Wed, 13 Aug 2025 09:15:14 GMT',
  panel: 'hpanel',
  platform: 'hostinger',
  server: 'hcdn',
  'transfer-encoding': 'chunked',
  vary: 'Accept-Encoding',
  'x-content-type-options': 'nosniff',
  'x-graphql-url': 'maroon-lapwing-781450.hostingersite.com/graphql',
  'x-hcdn-cache-status': 'DYNAMIC',
  'x-hcdn-request-id': '5116ad22c8c55665801c7bad00c1ff55-mum-edge5',
  'x-hcdn-upstream-rt': '0.782',
  'x-litespeed-cache-control': 'no-cache',
  'x-powered-by': 'PHP/8.2.28',
  'x-robots-tag': 'noindex'
}
📄 GraphQL Proxy - Content-Type: application/json; charset=UTF-8
✅ GraphQL Proxy - Response data: {
  "errors": [
    {
      "message": "No product ID was found corresponding to the database_id: cG9zdDo2Mg==",
      "locations": [
        {
          "line": 3,
          "column": 9
        }
      ],
      "path": [
        "product"
      ]
    }
  ],
  "data": {
    "product": null
  },
  "extensions": {
    "debug": [
      {
        "type": "DEBUG_LOGS_INACTIVE",
        "message": "GraphQL Debug logging is not active. To see debug logs, GRAPHQL_DEBUG must be enabled."
      }
    ]
  }
}
 POST /api/graphql 200 in 1041ms
🔄 GraphQL Proxy - Response status: 200
🔄 GraphQL Proxy - Response headers: {
  'access-control-allow-headers': 'Authorization, Content-Type, X-JWT-Auth, X-JWT-Refresh, woocommerce-session',
  'access-control-allow-origin': '*',
  'access-control-expose-headers': 'X-JWT-Refresh, woocommerce-session',
  'access-control-max-age': '600',
  'cache-control': 'no-cache, no-store, must-revalidate, max-age=0',
  connection: 'keep-alive',
  'content-encoding': 'br',
  'content-security-policy': 'upgrade-insecure-requests',
  'content-type': 'application/json; charset=UTF-8',
  date: 'Wed, 13 Aug 2025 09:15:14 GMT',
  panel: 'hpanel',
  platform: 'hostinger',
  server: 'hcdn',
  'transfer-encoding': 'chunked',
  vary: 'Accept-Encoding',
  'x-content-type-options': 'nosniff',
  'x-graphql-url': 'maroon-lapwing-781450.hostingersite.com/graphql',
  'x-hcdn-cache-status': 'DYNAMIC',
  'x-hcdn-request-id': 'e2ebe615151a30e22b70a8788b3aee0d-mum-edge7',
  'x-hcdn-upstream-rt': '0.852',
  'x-litespeed-cache-control': 'no-cache',
  'x-powered-by': 'PHP/8.2.28',
  'x-robots-tag': 'noindex'
}
📄 GraphQL Proxy - Content-Type: application/json; charset=UTF-8
✅ GraphQL Proxy - Response data: {
  "errors": [
    {
      "message": "No product ID was found corresponding to the database_id: cG9zdDo2Mg==",
      "locations": [
        {
          "line": 3,
          "column": 9
        }
      ],
      "path": [
        "product"
      ]
    }
  ],
  "data": {
    "product": null
  },
  "extensions": {
    "debug": [
      {
        "type": "DEBUG_LOGS_INACTIVE",
        "message": "GraphQL Debug logging is not active. To see debug logs, GRAPHQL_DEBUG must be enabled."
      }
    ]
  }
}
 POST /api/graphql 200 in 1059ms
[?25h
